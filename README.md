# Zabbix PostgreSQL Backup

## How to Implement This Code

### 1. Clone the Repository

```sh
git clone https://github.com/n0ctem32/zabbix-postgresql-backup.git
cd zabbix-postgresql-backup
```

---

### 2. Configure the Backup Script

Edit the `pg_backup.conf` file to match your PostgreSQL environment:

```ini
PGHOST=localhost
PGPORT=5432
PGUSER=postgres
PGPASSWORD=yourpassword
PGDATABASE=yourdatabase
BACKUP_DIR=/var/backups/postgresql
RETENTION_DAYS=7
```

**Security Tip:**
Do not commit real passwords to public repositories. Use environment variables or a `.pgpass` file for production.

---

### 3. Set Proper File Permissions

Make the script executable:

```sh
chmod +x pg_backup_monitor.sh
```

Restrict access to the configuration and backup files:

```sh
chmod 600 pg_backup.conf
chmod 700 /var/backups/postgresql
```

---

### 4. Run the Script

To run the backup manually:

```sh
./pg_backup_monitor.sh
```

---

### 5. Automate with Cron (Optional)

To schedule daily backups, add a cron job:

```sh
crontab -e
```

Add this line to run the script every day at 2am:

```sh
0 2 * * * /path/to/pg_backup_monitor.sh
```

---

### 6. Integrate with Zabbix

- Ensure the Zabbix agent can read the status/log files generated by the script.
- (Template to be added) Create Zabbix items to monitor backup status, file age, and errors.

---

### 7. Security & Best Practices

- Use environment variables or a `.pgpass` file for passwords in production.
- Restrict permissions on backup and config files.
- Never commit sensitive data to public repositories.

---

### 8. Need Help?

- For questions, open an issue on GitHub.
- Contributions are welcome!

--- 